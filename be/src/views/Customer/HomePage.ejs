<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <title>ejs</title>
    <link rel="stylesheet" href="../css/global.css" />
    <link rel="stylesheet" href="../css/HomePage.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Mulish:wght@500;600;700;800&display=swap" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Gotham:ital,wght@0,300;0,400;0,500;0,700;1,400&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poller One:wght@400&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Prosto One:wght@400&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Plus Jakarta Sans:wght@500&display=swap" />
</head>

<body>
    <div class="homepage">
        <div class="fintech">

            <b class="bankinging">Bankinging</b>
            <header class="text-input">
                <div class="t-r-a-n-s-a-c-t-i-o-n-h-i-s-t-parent">
                    <div class="t-r-a-n-s-a-c-t-i-o-n-h-i-s-t">
                        <div class="logout-text">
                            <img class="frame-wrapper" loading="lazy" alt="" src="../images/logo.jpg" />
                            <div class="pay">PAY</div>
                        </div>
                        <div class="get-card">GET CARD</div>
                        <div class="about-us">ABOUT US</div>
                        <div class="contact-us">CONTACT US</div>
                    </div>
                    <div class="how-it-works-frame-parent">
                        <div class="how-it-works-frame">
                            <div class="profile" id="pageProfile">PROFILE</div>
                        </div>
                        <div class="balance-frame">
                            <div class="pay-tuition-fee" id="PaytuitionFee">
                                PAY TUITION FEE
                            </div>
                        </div>
                        <div class="balance-frame1">
                            <div class="transaction-history" id="AnnouncementPage">
                                ANNOUNCEMENTPAGE
                            </div>
                        </div>
                        <div class="balance-frame1">
                            <div class="transaction-history" id="TransactionHistory">
                                TRANSACTION HISTORY
                            </div>
                        </div>
                        <div class="auto-layout-horizontal" id="autoLayoutHorizontal">
                            <div class="group1">
                                <div class="rectangle2"></div>
                                <div class="log-out">Log out</div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <div class="fintech-inner">
                <div class="group-wrapper">
                    <main class="group2">
                        <div class="info-card">
                            <div class="group-frame1">
                                <div class="i-banking-text">
                                    <div class="transactions-frame">
                                        <div class="ibanking2">IBanking</div>
                                        <div class="auto-layout-horizontal1">
                                            <img class="group-icon" loading="lazy" alt=""
                                                src="../images/img_hq_1.png" />

                                            <div class="auto-layout-horizontal2">
                                                <div class="auto-layout-vertical">
                                                    <b class="m">$ ...M+</b>
                                                    <div class="transactions">Transactions</div>
                                                </div>
                                                <div class="auto-layout-vertical1"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="group-frame-inner">
                                    <div class="frame-parent4">
                                        <img class="frame-child11" loading="lazy" alt="" src="../images/img_hq_2.png" />

                                        <div class="account-balance1">Account Balance</div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <section class="s-d-t">
                            <div class="email-label">
                                <div class="p-r-o-c-e-s-s"></div>
                                <div class="ellipse1">
                                    <h2 class=" how-it-works">Internet Banking</h2>
                                    <p>Is an online banking service that allows customers to perform financial
                                        transactions via the internet. Users can access accounts, check balances,
                                        transfer funds, pay bills, and even make investment transactions anytime,
                                        anywhere through a safe and highly secure interface. The iBanking system often
                                        uses authentication codes and security measures to ensure user privacy and
                                        safety.</p>
                                </div>
                            </div>
                            <div class="profile-frame1">
                                <div class="i-banking-text-parent">
                                    <div class="i-banking-text1">
                                        <div class="customer-info-frame">
                                            <div class="frame-parent5">
                                                <div class="ellipse-parent">
                                                    <div class="ellipse2"></div>
                                                    <div class="transactions-text">
                                                        <div class="ellipse3"></div>
                                                        <div class="transaction-card-frame"></div>
                                                    </div>
                                                </div>
                                                <div class="frame-child12"></div>
                                                <div class="payment-and-history-group">
                                                    <div class="customer-information">
                                                        Họ tên:
                                                        <span id="fullName"></span>
                                                    </div>
                                                </div>
                                                <div class="email-text">
                                                    <div class="how-it-works-text">
                                                        <div class="account-balance2">
                                                            Số dư khả dụng:
                                                            <span id="amount"></span>
                                                        </div>
                                                    </div>
                                                    <div class="sdt">Số điện thoại: <span id="phoneNumber"></span></div>
                                                </div>
                                                <div class="frame-with-pay-tuition-fee-and">
                                                    <div class="email1">
                                                        <span id="email"></span>
                                                    </div>
                                                </div>
                                                <div class="payment-and-history-group1">
                                                    <div class="xxxxxx">
                                                        XXXXXX:......................
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="how-it-works">How it works</div>
                                </div>
                            </div>

                        </section>
                    </main>
                </div>
            </div>
        </div>
    </div>

    <script>
        var pageProfile = document.getElementById("pageProfile");
        if (pageProfile) {
            pageProfile.addEventListener("click", function (e) {
                window.location.href = "/homepage/profileuser";
            });
        }

        var PaytuitionFee = document.getElementById("PaytuitionFee");
        if (PaytuitionFee) {
            PaytuitionFee.addEventListener("click", function (e) {
                window.location.href = "/homepage/paymentoftuitionfees";
            });
        }

        var TransactionHistory = document.getElementById("TransactionHistory");
        if (TransactionHistory) {
            TransactionHistory.addEventListener("click", function (e) {
                window.location.href = "/homepage/transactionhistory";
            });
        }

        var AnnouncementPage = document.getElementById("AnnouncementPage");
        if (AnnouncementPage) {
            AnnouncementPage.addEventListener("click", function (e) {
                window.location.href = "/homepage/announcementpage";
            });
        }

        var autoLayoutHorizontal = document.getElementById("autoLayoutHorizontal");
        if (autoLayoutHorizontal) {
            autoLayoutHorizontal.addEventListener("click", function (e) {
                // Xóa token từ localStorage
                localStorage.removeItem('token');
                // Điều hướng người dùng đến trang chính (homepage)
                window.location.href = "/";
            });
        }

        // Check xem token đã được lưu trong localStorage chưa
        var storedToken = localStorage.getItem('token');
        if (storedToken) {
            console.log('Token found in localStorage:', storedToken);

            // Gửi yêu cầu fetch với mã token
            fetch('/api/fetchData', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${storedToken}` // Thêm mã token vào tiêu đề "Authorization"
                }
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.user) {
                        // Hiển thị dữ liệu người dùng trong trang HTML
                        document.getElementById('fullName').textContent = data.user.fullName || 'N/A';
                        document.getElementById('phoneNumber').textContent = data.user.phoneNumber || 'N/A';
                        // Sử dụng giá trị balance thay vì amount
                        var balance = data.user.balance;
                        document.getElementById('amount').textContent = Number.isInteger(balance) ? balance : 'N/A';
                        document.getElementById('email').textContent = data.user.email || 'N/A';
                    } else {
                        console.log('Error fetching user data:', data.message || 'Unknown error');
                        // Xử lý trường hợp không tìm thấy hoặc lỗi trong dữ liệu người dùng
                    }

                })
                .catch(error => {
                    console.error('Error fetching user data:', error);
                });
        } else {
            console.log('Token not found in localStorage');
            // Nếu token không được tìm thấy, bạn có thể thực hiện xử lý khác tùy theo nhu cầu của bạn
        }

    </script>
</body>

</html>